{"results": [{"node": {"raw_sql": "With Src_Kat_MobileCircuit as (\r\n\r\n    select * from {{ source('kat', 'MobileCircuit') }}\r\n),\r\n\r\nstg_kat_mobilecircuit as (\r\n\r\n    select\r\n      [CircuitID]\r\n      ,[Mobile Terminal]\r\n      ,[Root Terminal]\r\n      ,[Circuit Status]\r\n      ,[Damage Mark]\r\n      ,[Cable Share Plant]\r\n      ,[Last mile Terminal]\r\n      ,[Group Circuit]\r\n      ,[Group Circuit T1]\r\n      ,[Group Circuit T2]\r\n      ,[Group Circuit Position]\r\n      ,[Group Circuit Type]\r\n      ,getdate() as LoadDateTime\r\n    from \r\n      Src_Kat_MobileCircuit\r\n    where \r\n      [Circuit Status] in ('Active','Damaged')\r\n\r\n)\r\n\r\nselect * from stg_kat_mobilecircuit", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "staging", "kat", "stg_kat_mobilecircuit"], "unique_id": "model.tdcnet_bi.stg_kat_mobilecircuit", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "staging\\kat\\stg_kat_mobilecircuit.sql", "original_file_path": "models\\staging\\kat\\stg_kat_mobilecircuit.sql", "name": "stg_kat_mobilecircuit", "resource_type": "model", "alias": "stg_kat_mobilecircuit", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["kat", "MobileCircuit"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.tdcnet_bi.kat.MobileCircuit"]}, "description": "", "columns": {"CircuitID": {"name": "CircuitID", "description": "Unique identifier for a Circuit in network. Primary key of the table.", "meta": {}, "data_type": null, "tags": []}, "Mobile Terminal": {"name": "Mobile Terminal", "description": "Mobile terminal to which circuit belongs to.", "meta": {}, "data_type": null, "tags": []}, "Root Terminal": {"name": "Root Terminal", "description": "Root terminal to which circuit belongs to.", "meta": {}, "data_type": null, "tags": []}, "[Circuit Status]": {"name": "[Circuit Status]", "description": "Status of the circuit i.e., Active, Damaged etc.", "meta": {}, "data_type": null, "tags": []}, "Damage Mark": {"name": "Damage Mark", "description": "Marker indicating whether the circuit is damaged or not.", "meta": {}, "data_type": null, "tags": []}, "Cable Share Plant": {"name": "Cable Share Plant", "description": "Transmission path of the circuit. Holds value only if there is a share path. Value is a combination of Lmile Terminal, Mobile Terminal and cable number. FK to kat.circuitsharedplant.", "meta": {}, "data_type": null, "tags": []}, "Last mile Terminal": {"name": "Last mile Terminal", "description": "Last mile terminal of the circuit.", "meta": {}, "data_type": null, "tags": []}, "Group Circuit": {"name": "Group Circuit", "description": "Group circuit to which the circuit belongs to. Value is combination of Terminal 1 - Terminal 2 Group Circuit Type.", "meta": {}, "data_type": null, "tags": []}, "Group Circuit T1": {"name": "Group Circuit T1", "description": "Terminal 1 of the group circuit.", "meta": {}, "data_type": null, "tags": []}, "Group Circuit T2": {"name": "Group Circuit T2", "description": "Terminal 2 of the group circuit.", "meta": {}, "data_type": null, "tags": []}, "Group Circuit Position": {"name": "Group Circuit Position", "description": "Group circuit position.", "meta": {}, "data_type": null, "tags": []}, "Group Circuit Type": {"name": "Group Circuit Type", "description": "Type of the group circuit i.e., 10g, vcs4s etc.", "meta": {}, "data_type": null, "tags": []}, "LoadDateTime": {"name": "LoadDateTime", "description": "Load Date and time of the data indicating the freshness of data.", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\staging\\kat\\kat.yml", "build_path": "target\\run\\tdcnet_bi\\staging\\kat\\stg_kat_mobilecircuit.sql", "compiled": true, "compiled_sql": "With Src_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DRA\".\"kat\".\"MobileCircuit\"\n),\n\nstg_kat_mobilecircuit as (\n\n    select\n      [CircuitID]\n      ,[Mobile Terminal]\n      ,[Root Terminal]\n      ,[Circuit Status]\n      ,[Damage Mark]\n      ,[Cable Share Plant]\n      ,[Last mile Terminal]\n      ,[Group Circuit]\n      ,[Group Circuit T1]\n      ,[Group Circuit T2]\n      ,[Group Circuit Position]\n      ,[Group Circuit Type]\n      ,getdate() as LoadDateTime\n    from \n      Src_Kat_MobileCircuit\n    where \n      [Circuit Status] in ('Active','Damaged')\n\n)\n\nselect * from stg_kat_mobilecircuit", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Src_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DRA\".\"kat\".\"MobileCircuit\"\n),\n\nstg_kat_mobilecircuit as (\n\n    select\n      [CircuitID]\n      ,[Mobile Terminal]\n      ,[Root Terminal]\n      ,[Circuit Status]\n      ,[Damage Mark]\n      ,[Cable Share Plant]\n      ,[Last mile Terminal]\n      ,[Group Circuit]\n      ,[Group Circuit T1]\n      ,[Group Circuit T2]\n      ,[Group Circuit Position]\n      ,[Group Circuit Type]\n      ,getdate() as LoadDateTime\n    from \n      Src_Kat_MobileCircuit\n    where \n      [Circuit Status] in ('Active','Damaged')\n\n)\n\nselect * from stg_kat_mobilecircuit", "wrapped_sql": null}, "error": null, "status": "12", "execution_time": 0.1185448169708252, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.307438Z", "completed_at": "2020-05-07T06:49:04.334198Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.334198Z", "completed_at": "2020-05-07T06:49:04.425492Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Src_Kat_Terminal as (\r\n\r\n    select * from {{ source('kat', 'Terminal') }}\r\n),\r\n\r\nstg_kat_terminal as (\r\n\r\n    select\r\n      [Terminal Id]\r\n      ,[Navn]\r\n      ,[Stednavn]\r\n      ,[Teknisk]\r\n      ,[Gade]\r\n      ,[Nr]\r\n      ,[Bogst]\r\n      ,[Etage]\r\n      ,[Lejl]\r\n      ,[PostNr]\r\n      ,[By]\r\n      ,[Geocode]\r\n      ,[Dok Central]\r\n      ,[Share Connection 1]\r\n      ,[Share Connection 2]\r\n      ,[Damage Mark]\r\n      ,getdate() as LoadDateTime\r\n    from Src_Kat_Terminal\r\n)\r\n\r\nselect * from stg_kat_terminal", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "staging", "kat", "stg_kat_terminal"], "unique_id": "model.tdcnet_bi.stg_kat_terminal", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "staging\\kat\\stg_kat_terminal.sql", "original_file_path": "models\\staging\\kat\\stg_kat_terminal.sql", "name": "stg_kat_terminal", "resource_type": "model", "alias": "stg_kat_terminal", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["kat", "Terminal"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.tdcnet_bi.kat.Terminal"]}, "description": "", "columns": {"[Terminal Id]": {"name": "[Terminal Id]", "description": "Unique identifier for a terminal. Can be a Mobile Terminal, Root Terminal, Group Circuit Terminal1, Group Circuit Terminal2. Primary key of the table.", "meta": {}, "data_type": null, "tags": []}, "Navn": {"name": "Navn", "description": "Name of the terminal. For mobile terminals, name is a combination of site id and site name which is used for correlating data from ramsite.", "meta": {}, "data_type": null, "tags": []}, "Stednavn": {"name": "Stednavn", "description": "Terminal1.", "meta": {}, "data_type": null, "tags": []}, "Teknisk": {"name": "Teknisk", "description": "Terminal2.", "meta": {}, "data_type": null, "tags": []}, "Gade": {"name": "Gade", "description": "Street of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Nr": {"name": "Nr", "description": "House number of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Bogst": {"name": "Bogst", "description": "Bogst of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Etage": {"name": "Etage", "description": "Etage of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Lejl": {"name": "Lejl", "description": "Lejl of the terminal.", "meta": {}, "data_type": null, "tags": []}, "PostNr": {"name": "PostNr", "description": "Post code where the terminal is located.", "meta": {}, "data_type": null, "tags": []}, "By": {"name": "By", "description": "City where the terminal is located.", "meta": {}, "data_type": null, "tags": []}, "Geocode": {"name": "Geocode", "description": "Geocode of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Dok Central": {"name": "Dok Central", "description": "Dok central to which the terminal belongs to.", "meta": {}, "data_type": null, "tags": []}, "Share Connection 1": {"name": "Share Connection 1", "description": "Share Connection 1 of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Share Connection 2": {"name": "Share Connection 2", "description": "Share Connection 2 of the terminal.", "meta": {}, "data_type": null, "tags": []}, "Damage Mark": {"name": "Damage Mark", "description": "Damage marker of the terminal.", "meta": {}, "data_type": null, "tags": []}, "LoadDateTime": {"name": "LoadDateTime", "description": "Load Date and time of the data indicating the freshness of data.", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\staging\\kat\\kat.yml", "build_path": "target\\run\\tdcnet_bi\\staging\\kat\\stg_kat_terminal.sql", "compiled": true, "compiled_sql": "With Src_Kat_Terminal as (\n\n    select * from \"DDMP_DRA\".\"kat\".\"Terminal\"\n),\n\nstg_kat_terminal as (\n\n    select\n      [Terminal Id]\n      ,[Navn]\n      ,[Stednavn]\n      ,[Teknisk]\n      ,[Gade]\n      ,[Nr]\n      ,[Bogst]\n      ,[Etage]\n      ,[Lejl]\n      ,[PostNr]\n      ,[By]\n      ,[Geocode]\n      ,[Dok Central]\n      ,[Share Connection 1]\n      ,[Share Connection 2]\n      ,[Damage Mark]\n      ,getdate() as LoadDateTime\n    from Src_Kat_Terminal\n)\n\nselect * from stg_kat_terminal", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Src_Kat_Terminal as (\n\n    select * from \"DDMP_DRA\".\"kat\".\"Terminal\"\n),\n\nstg_kat_terminal as (\n\n    select\n      [Terminal Id]\n      ,[Navn]\n      ,[Stednavn]\n      ,[Teknisk]\n      ,[Gade]\n      ,[Nr]\n      ,[Bogst]\n      ,[Etage]\n      ,[Lejl]\n      ,[PostNr]\n      ,[By]\n      ,[Geocode]\n      ,[Dok Central]\n      ,[Share Connection 1]\n      ,[Share Connection 2]\n      ,[Damage Mark]\n      ,getdate() as LoadDateTime\n    from Src_Kat_Terminal\n)\n\nselect * from stg_kat_terminal", "wrapped_sql": null}, "error": null, "status": "50", "execution_time": 0.11458206176757812, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.428437Z", "completed_at": "2020-05-07T06:49:04.444804Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.444804Z", "completed_at": "2020-05-07T06:49:04.542549Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Src_Ramsite_Cell as (\r\n\r\n    select * from {{ source('ramsite', 'cell') }}\r\n),\r\n\r\nstg_ramsite_cell as (\r\n\r\n    select\r\n      [Cell Id]\r\n      ,[Site Id]\r\n      ,[Name]\r\n      ,[Status]\r\n      ,[System Type]\r\n      ,[Traffic Area]\r\n      ,[Position]\r\n      ,[Azimuth]\r\n      ,[Sector]\r\n      ,[Center Name]\r\n      ,[Radius]\r\n      ,[NodeName]\r\n      ,[eNodeB ID]\r\n      ,[gNodeB ID]\r\n      ,[BSC_RNC]\r\n      ,getdate() as LoadDateTime\r\n    from Src_Ramsite_Cell\r\n\r\n)\r\n\r\nselect * from stg_ramsite_cell", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "staging", "ramsite", "stg_ramsite_cell"], "unique_id": "model.tdcnet_bi.stg_ramsite_cell", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "staging\\ramsite\\stg_ramsite_cell.sql", "original_file_path": "models\\staging\\ramsite\\stg_ramsite_cell.sql", "name": "stg_ramsite_cell", "resource_type": "model", "alias": "stg_ramsite_cell", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["ramsite", "cell"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.tdcnet_bi.ramsite.cell"]}, "description": "", "columns": {"[Cell Id]": {"name": "[Cell Id]", "description": "Unique identifier for a cell in site. Primary key of the table.", "meta": {}, "data_type": null, "tags": []}, "Site Id": {"name": "Site Id", "description": "Reference to the site to which the cell belongs. Foreign Key of ramsite.Site.", "meta": {}, "data_type": null, "tags": []}, "Name": {"name": "Name", "description": "Name of the cell.", "meta": {}, "data_type": null, "tags": []}, "Status": {"name": "Status", "description": "Status of the cell i.e., OnAir, Disabled, Not On Air.", "meta": {}, "data_type": null, "tags": []}, "System Type": {"name": "System Type", "description": "System type of the cell i.e., LTE800, UMTS2100, GSM900 etc.", "meta": {}, "data_type": null, "tags": []}, "Traffic Area": {"name": "Traffic Area", "description": "Traffic area to which the cell belongs.", "meta": {}, "data_type": null, "tags": []}, "Position": {"name": "Position", "description": "Position of the cell.", "meta": {}, "data_type": null, "tags": []}, "Azimuth": {"name": "Azimuth", "description": "Degree of rotation to which cell is installed i.e., 180, 360 etc.", "meta": {}, "data_type": null, "tags": []}, "Sector": {"name": "Sector", "description": "Name of the sector to which cell belongs.", "meta": {}, "data_type": null, "tags": []}, "Center Name": {"name": "Center Name", "description": "Name of the center to which cell belongs.", "meta": {}, "data_type": null, "tags": []}, "Radius": {"name": "Radius", "description": "Radius of the cell.", "meta": {}, "data_type": null, "tags": []}, "NodeName": {"name": "NodeName", "description": "Node name of the cell.", "meta": {}, "data_type": null, "tags": []}, "eNodeB ID": {"name": "eNodeB ID", "description": "eNodeB ID of the cell.", "meta": {}, "data_type": null, "tags": []}, "gNodeB ID": {"name": "gNodeB ID", "description": "gNodeB ID of the cell.", "meta": {}, "data_type": null, "tags": []}, "BSC_RNC": {"name": "BSC_RNC", "description": "BSC RNC of the cell.", "meta": {}, "data_type": null, "tags": []}, "LoadDateTime": {"name": "LoadDateTime", "description": "Load Date and time of the data indicating the freshness of data.", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\staging\\ramsite\\ramsite.yml", "build_path": "target\\run\\tdcnet_bi\\staging\\ramsite\\stg_ramsite_cell.sql", "compiled": true, "compiled_sql": "With Src_Ramsite_Cell as (\n\n    select * from \"DDMP_DRA\".\"ramsite\".\"cell\"\n),\n\nstg_ramsite_cell as (\n\n    select\n      [Cell Id]\n      ,[Site Id]\n      ,[Name]\n      ,[Status]\n      ,[System Type]\n      ,[Traffic Area]\n      ,[Position]\n      ,[Azimuth]\n      ,[Sector]\n      ,[Center Name]\n      ,[Radius]\n      ,[NodeName]\n      ,[eNodeB ID]\n      ,[gNodeB ID]\n      ,[BSC_RNC]\n      ,getdate() as LoadDateTime\n    from Src_Ramsite_Cell\n\n)\n\nselect * from stg_ramsite_cell", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Src_Ramsite_Cell as (\n\n    select * from \"DDMP_DRA\".\"ramsite\".\"cell\"\n),\n\nstg_ramsite_cell as (\n\n    select\n      [Cell Id]\n      ,[Site Id]\n      ,[Name]\n      ,[Status]\n      ,[System Type]\n      ,[Traffic Area]\n      ,[Position]\n      ,[Azimuth]\n      ,[Sector]\n      ,[Center Name]\n      ,[Radius]\n      ,[NodeName]\n      ,[eNodeB ID]\n      ,[gNodeB ID]\n      ,[BSC_RNC]\n      ,getdate() as LoadDateTime\n    from Src_Ramsite_Cell\n\n)\n\nselect * from stg_ramsite_cell", "wrapped_sql": null}, "error": null, "status": "48", "execution_time": 0.07739543914794922, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.544995Z", "completed_at": "2020-05-07T06:49:04.560868Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.561397Z", "completed_at": "2020-05-07T06:49:04.621399Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Src_Ramsite_Site as (\r\n\r\n    select * from {{ source('ramsite', 'site') }}\r\n),\r\n\r\nstg_ramsite_site as (\r\n\r\n    select\r\n      [Site Id]\r\n      ,[Site Name]\r\n      ,[English Name]\r\n      ,[Cluster]\r\n      ,[Priority]\r\n      ,[RNC ID]\r\n      ,[BSC ID]\r\n      ,[EPC ID]\r\n      ,[Site Status]\r\n      ,[Address 1]\r\n      ,[House No]\r\n      ,[PostCode]\r\n      ,[City]\r\n      ,[Municipality]\r\n      ,[County]\r\n      ,[Country]\r\n      ,[Easting UTM32-ED50]\r\n      ,[Northing UTM32-ED50]\r\n      ,[Longitude-WGS84]\r\n      ,[Latitude-WGS84]\r\n      ,[Site Type]\r\n      ,[Structure Type]\r\n      ,[Transmission Name]\r\n      ,[CircuitIds]\r\n      ,getdate() as LoadDateTime\r\n    from Src_Ramsite_Site\r\n    Where\r\n        [Site Status] in ('Ready','On Air')\r\n\r\n)\r\n\r\nselect * from stg_ramsite_site", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "staging", "ramsite", "stg_ramsite_site"], "unique_id": "model.tdcnet_bi.stg_ramsite_site", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "staging\\ramsite\\stg_ramsite_site.sql", "original_file_path": "models\\staging\\ramsite\\stg_ramsite_site.sql", "name": "stg_ramsite_site", "resource_type": "model", "alias": "stg_ramsite_site", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["ramsite", "site"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.tdcnet_bi.ramsite.site"]}, "description": "", "columns": {"[Site Id]": {"name": "[Site Id]", "description": "Unique identifier of a Site in RamSite. Primary key of the table.", "meta": {}, "data_type": null, "tags": []}, "Site Name": {"name": "Site Name", "description": "Name of the site in danish.", "meta": {}, "data_type": null, "tags": []}, "English Name": {"name": "English Name", "description": "English translation of the site name.", "meta": {}, "data_type": null, "tags": []}, "Cluster": {"name": "Cluster", "description": "Cluster to which the site belongs to.", "meta": {}, "data_type": null, "tags": []}, "Priority": {"name": "Priority", "description": "Business priority of the site e.g. Priority 2, VIP cell site.", "meta": {}, "data_type": null, "tags": []}, "RNC ID": {"name": "RNC ID", "description": "RNC ID of the site.", "meta": {}, "data_type": null, "tags": []}, "BSC ID": {"name": "BSC ID", "description": "BSC ID of the site.", "meta": {}, "data_type": null, "tags": []}, "EPC ID": {"name": "EPC ID", "description": "EPC ID of the site.", "meta": {}, "data_type": null, "tags": []}, "[Site Status]": {"name": "[Site Status]", "description": "Status of the site i.e., On Air, Ready, Planned.", "meta": {}, "data_type": null, "tags": []}, "Address 1": {"name": "Address 1", "description": "Street Name/Address line 1 of the site .", "meta": {}, "data_type": null, "tags": []}, "House No": {"name": "House No", "description": "House number of the site.", "meta": {}, "data_type": null, "tags": []}, "PostCode": {"name": "PostCode", "description": "Postal code of the site.", "meta": {}, "data_type": null, "tags": []}, "City": {"name": "City", "description": "City to which the site belongs to.", "meta": {}, "data_type": null, "tags": []}, "Municipality": {"name": "Municipality", "description": "Municipality to which the site belongs.", "meta": {}, "data_type": null, "tags": []}, "County": {"name": "County", "description": "County/Region to which the site belongs to.", "meta": {}, "data_type": null, "tags": []}, "Country": {"name": "Country", "description": "Country of the site.", "meta": {}, "data_type": null, "tags": []}, "Easting UTM32-ED50": {"name": "Easting UTM32-ED50", "description": "Easting coordinates of the site.", "meta": {}, "data_type": null, "tags": []}, "Northing UTM32-ED50": {"name": "Northing UTM32-ED50", "description": "Northing coordinates of the site.", "meta": {}, "data_type": null, "tags": []}, "Longitude-WGS84": {"name": "Longitude-WGS84", "description": "Longitude of the site in WGS84 format.", "meta": {}, "data_type": null, "tags": []}, "Latitude-WGS84": {"name": "Latitude-WGS84", "description": "Latitude of the site in WGS84 format.", "meta": {}, "data_type": null, "tags": []}, "Site Type": {"name": "Site Type", "description": "Type of site i.e, MACRO or IBS etc.", "meta": {}, "data_type": null, "tags": []}, "Structure Type": {"name": "Structure Type", "description": "Structure type of the site i.e., Bygning, Indend\u00f8rssystem etc.", "meta": {}, "data_type": null, "tags": []}, "Transmission Name": {"name": "Transmission Name", "description": "Name of the transmission.", "meta": {}, "data_type": null, "tags": []}, "CircuitIds": {"name": "CircuitIds", "description": "Circuits available on the site with a comma separated values along with letter indicating the technology e.g., HJ910240,HN173010,MD150031L,MD150031U.", "meta": {}, "data_type": null, "tags": []}, "LoadDateTime": {"name": "LoadDateTime", "description": "Load Date and time of the data indicating the freshness of data.", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\staging\\ramsite\\ramsite.yml", "build_path": "target\\run\\tdcnet_bi\\staging\\ramsite\\stg_ramsite_site.sql", "compiled": true, "compiled_sql": "With Src_Ramsite_Site as (\n\n    select * from \"DDMP_DRA\".\"ramsite\".\"site\"\n),\n\nstg_ramsite_site as (\n\n    select\n      [Site Id]\n      ,[Site Name]\n      ,[English Name]\n      ,[Cluster]\n      ,[Priority]\n      ,[RNC ID]\n      ,[BSC ID]\n      ,[EPC ID]\n      ,[Site Status]\n      ,[Address 1]\n      ,[House No]\n      ,[PostCode]\n      ,[City]\n      ,[Municipality]\n      ,[County]\n      ,[Country]\n      ,[Easting UTM32-ED50]\n      ,[Northing UTM32-ED50]\n      ,[Longitude-WGS84]\n      ,[Latitude-WGS84]\n      ,[Site Type]\n      ,[Structure Type]\n      ,[Transmission Name]\n      ,[CircuitIds]\n      ,getdate() as LoadDateTime\n    from Src_Ramsite_Site\n    Where\n        [Site Status] in ('Ready','On Air')\n\n)\n\nselect * from stg_ramsite_site", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Src_Ramsite_Site as (\n\n    select * from \"DDMP_DRA\".\"ramsite\".\"site\"\n),\n\nstg_ramsite_site as (\n\n    select\n      [Site Id]\n      ,[Site Name]\n      ,[English Name]\n      ,[Cluster]\n      ,[Priority]\n      ,[RNC ID]\n      ,[BSC ID]\n      ,[EPC ID]\n      ,[Site Status]\n      ,[Address 1]\n      ,[House No]\n      ,[PostCode]\n      ,[City]\n      ,[Municipality]\n      ,[County]\n      ,[Country]\n      ,[Easting UTM32-ED50]\n      ,[Northing UTM32-ED50]\n      ,[Longitude-WGS84]\n      ,[Latitude-WGS84]\n      ,[Site Type]\n      ,[Structure Type]\n      ,[Transmission Name]\n      ,[CircuitIds]\n      ,getdate() as LoadDateTime\n    from Src_Ramsite_Site\n    Where\n        [Site Status] in ('Ready','On Air')\n\n)\n\nselect * from stg_ramsite_site", "wrapped_sql": null}, "error": null, "status": "10", "execution_time": 0.10217666625976562, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.624366Z", "completed_at": "2020-05-07T06:49:04.646675Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.647171Z", "completed_at": "2020-05-07T06:49:04.725538Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Src_Kat_SharedCablePlant as (\r\n\r\n    select * from {{ source('kat', 'SharedCablePlant') }}\r\n),\r\n\r\nstg_kat_sharedcableplant as (\r\n\r\n    select\r\n       [Share Cable Id]\r\n      ,[Share Cable Nr]\r\n      ,[Last Mile Cable Junction]\r\n      ,[Last Mile Junction Terminal]\r\n      ,[Mobile Terminal]\r\n      ,[Root Terminal]\r\n      ,[Cable Status]\r\n      ,[Damage Mark]\r\n      ,getdate() as LoadDateTime\r\n    from \r\n        Src_Kat_SharedCablePlant\r\n    where \r\n        [Cable Status] in ('Active','Damaged')\r\n)\r\n\r\nselect * from stg_kat_sharedcableplant", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "staging", "kat", "stg_kat_sharedcableplant"], "unique_id": "model.tdcnet_bi.stg_kat_sharedcableplant", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "staging\\kat\\stg_kat_sharedcableplant.sql", "original_file_path": "models\\staging\\kat\\stg_kat_sharedcableplant.sql", "name": "stg_kat_sharedcableplant", "resource_type": "model", "alias": "stg_kat_sharedcableplant", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["kat", "SharedCablePlant"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.tdcnet_bi.kat.SharedCablePlant"]}, "description": "", "columns": {"[Share Cable Id]": {"name": "[Share Cable Id]", "description": "Unique identifier for a share cable transmission path. Primary key of the table. Value is a combination of Lmile Terminal, Mobile Terminal and cable number.", "meta": {}, "data_type": null, "tags": []}, "Share Cable Nr": {"name": "Share Cable Nr", "description": "Cable number of the shared cable plant.", "meta": {}, "data_type": null, "tags": []}, "Last Mile Cable Junction": {"name": "Last Mile Cable Junction", "description": "Last mile cable junction of the shared cable plant.", "meta": {}, "data_type": null, "tags": []}, "Last Mile Junction Terminal": {"name": "Last Mile Junction Terminal", "description": "Last mile junction terminal of the shared cable plant.", "meta": {}, "data_type": null, "tags": []}, "Mobile Terminal": {"name": "Mobile Terminal", "description": "Mobile terminal of shared cable plant.", "meta": {}, "data_type": null, "tags": []}, "Root Terminal": {"name": "Root Terminal", "description": "Root terminal of shared cable plant.", "meta": {}, "data_type": null, "tags": []}, "[Cable Status]": {"name": "[Cable Status]", "description": "Cable status i.e., Active, Damaged etc.", "meta": {}, "data_type": null, "tags": []}, "Damage Mark": {"name": "Damage Mark", "description": "Marker indicating if the Cable is damaged or not.", "meta": {}, "data_type": null, "tags": []}, "LoadDateTime": {"name": "LoadDateTime", "description": "Load Date and time of the data indicating the freshness of data.", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\staging\\kat\\kat.yml", "build_path": "target\\run\\tdcnet_bi\\staging\\kat\\stg_kat_sharedcableplant.sql", "compiled": true, "compiled_sql": "With Src_Kat_SharedCablePlant as (\n\n    select * from \"DDMP_DRA\".\"kat\".\"SharedCablePlant\"\n),\n\nstg_kat_sharedcableplant as (\n\n    select\n       [Share Cable Id]\n      ,[Share Cable Nr]\n      ,[Last Mile Cable Junction]\n      ,[Last Mile Junction Terminal]\n      ,[Mobile Terminal]\n      ,[Root Terminal]\n      ,[Cable Status]\n      ,[Damage Mark]\n      ,getdate() as LoadDateTime\n    from \n        Src_Kat_SharedCablePlant\n    where \n        [Cable Status] in ('Active','Damaged')\n)\n\nselect * from stg_kat_sharedcableplant", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Src_Kat_SharedCablePlant as (\n\n    select * from \"DDMP_DRA\".\"kat\".\"SharedCablePlant\"\n),\n\nstg_kat_sharedcableplant as (\n\n    select\n       [Share Cable Id]\n      ,[Share Cable Nr]\n      ,[Last Mile Cable Junction]\n      ,[Last Mile Junction Terminal]\n      ,[Mobile Terminal]\n      ,[Root Terminal]\n      ,[Cable Status]\n      ,[Damage Mark]\n      ,getdate() as LoadDateTime\n    from \n        Src_Kat_SharedCablePlant\n    where \n        [Cable Status] in ('Active','Damaged')\n)\n\nselect * from stg_kat_sharedcableplant", "wrapped_sql": null}, "error": null, "status": "6", "execution_time": 0.0714559555053711, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.728516Z", "completed_at": "2020-05-07T06:49:04.744388Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.744916Z", "completed_at": "2020-05-07T06:49:04.798979Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Stg_Kat_MobileCircuit as (\r\n\r\n    select * from {{ ref('stg_kat_mobilecircuit') }}\r\n),\r\ncircuit_group as (\r\nselect distinct\r\n             [Group Circuit T1]+'-'+[Group Circuit T2] as [Circuit Group ID],\r\n             [Group Circuit T1],\r\n             [Group Circuit T2],\r\n             [Group Circuit Type] as [Group Type]\r\nfrom \r\n             Stg_Kat_MobileCircuit\r\nwhere \r\n             [Group Circuit] is not null\r\n)\r\n\r\nselect * from circuit_group", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "circuit_group"], "unique_id": "model.tdcnet_bi.circuit_group", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\circuit_group.sql", "original_file_path": "models\\marts\\remedy\\circuit_group.sql", "name": "circuit_group", "resource_type": "model", "alias": "circuit_group", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_kat_mobilecircuit"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_kat_mobilecircuit"]}, "description": "", "columns": {"Circuit Group ID": {"name": "Circuit Group ID", "description": "unique Circuit Group ID", "meta": {}, "data_type": null, "tags": []}, "Group Circuit T1": {"name": "Group Circuit T1", "description": "Group Circuit T1 , start mobile terminal", "meta": {}, "data_type": null, "tags": []}, "Group Circuit T2": {"name": "Group Circuit T2", "description": "Group Circuit T2 , End mobile terminal", "meta": {}, "data_type": null, "tags": []}, "Group Type": {"name": "Group Type", "description": "Group Type", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\circuit_group.sql", "compiled": true, "compiled_sql": "With Stg_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_mobilecircuit\"\n),\ncircuit_group as (\nselect distinct\n             [Group Circuit T1]+'-'+[Group Circuit T2] as [Circuit Group ID],\n             [Group Circuit T1],\n             [Group Circuit T2],\n             [Group Circuit Type] as [Group Type]\nfrom \n             Stg_Kat_MobileCircuit\nwhere \n             [Group Circuit] is not null\n)\n\nselect * from circuit_group", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Stg_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_mobilecircuit\"\n),\ncircuit_group as (\nselect distinct\n             [Group Circuit T1]+'-'+[Group Circuit T2] as [Circuit Group ID],\n             [Group Circuit T1],\n             [Group Circuit T2],\n             [Group Circuit Type] as [Group Type]\nfrom \n             Stg_Kat_MobileCircuit\nwhere \n             [Group Circuit] is not null\n)\n\nselect * from circuit_group", "wrapped_sql": null}, "error": null, "status": "3", "execution_time": 0.09723758697509766, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.802419Z", "completed_at": "2020-05-07T06:49:04.811845Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.812339Z", "completed_at": "2020-05-07T06:49:04.898172Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Stg_Kat_MobileCircuit as (\r\n\r\n    select * from {{ ref('stg_kat_mobilecircuit') }}\r\n),\r\n\r\nmobile_circuit as (\r\n\r\nselect \r\n              CircuitID ,\r\n             [Mobile Terminal] as [Terminal 1_MobileTerminal] ,\r\n             [Root Terminal] as [Terminal 2_RootTerminal], \r\n              [Circuit Status],\r\n             [Group Circuit] as [Logical Group Circuit] ,\r\n             [Group Circuit Position] as [Group Position]\r\nfrom    \r\n             Stg_Kat_MobileCircuit\r\n)\r\n\r\nselect * from mobile_circuit", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "mobile_circuit"], "unique_id": "model.tdcnet_bi.mobile_circuit", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\mobile_circuit.sql", "original_file_path": "models\\marts\\remedy\\mobile_circuit.sql", "name": "mobile_circuit", "resource_type": "model", "alias": "mobile_circuit", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_kat_mobilecircuit"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_kat_mobilecircuit"]}, "description": "", "columns": {"CircuitID": {"name": "CircuitID", "description": "unique CircuitID", "meta": {}, "data_type": null, "tags": []}, "Terminal 1_MobileTerminal": {"name": "Terminal 1_MobileTerminal", "description": "mobile terminal", "meta": {}, "data_type": null, "tags": []}, "Terminal 2_RootTerminal": {"name": "Terminal 2_RootTerminal", "description": "end-point of the Mobile Terminal (Root Terminal)", "meta": {}, "data_type": null, "tags": []}, "Circuit Status": {"name": "Circuit Status", "description": "circuit status Active/Damaged", "meta": {}, "data_type": null, "tags": []}, "Logical Group Circuit": {"name": "Logical Group Circuit", "description": "Relevant transmission group elements", "meta": {}, "data_type": null, "tags": []}, "Group Position": {"name": "Group Position", "description": "circuit group position (Grp St Pos.)", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\mobile_circuit.sql", "compiled": true, "compiled_sql": "With Stg_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_mobilecircuit\"\n),\n\nmobile_circuit as (\n\nselect \n              CircuitID ,\n             [Mobile Terminal] as [Terminal 1_MobileTerminal] ,\n             [Root Terminal] as [Terminal 2_RootTerminal], \n              [Circuit Status],\n             [Group Circuit] as [Logical Group Circuit] ,\n             [Group Circuit Position] as [Group Position]\nfrom    \n             Stg_Kat_MobileCircuit\n)\n\nselect * from mobile_circuit", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Stg_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_mobilecircuit\"\n),\n\nmobile_circuit as (\n\nselect \n              CircuitID ,\n             [Mobile Terminal] as [Terminal 1_MobileTerminal] ,\n             [Root Terminal] as [Terminal 2_RootTerminal], \n              [Circuit Status],\n             [Group Circuit] as [Logical Group Circuit] ,\n             [Group Circuit Position] as [Group Position]\nfrom    \n             Stg_Kat_MobileCircuit\n)\n\nselect * from mobile_circuit", "wrapped_sql": null}, "error": null, "status": "12", "execution_time": 0.07489681243896484, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.901618Z", "completed_at": "2020-05-07T06:49:04.918978Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.918978Z", "completed_at": "2020-05-07T06:49:04.975555Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With stg_kat_terminal as (\r\n\r\n    select * from {{ ref('stg_kat_terminal') }}\r\n),\r\n\r\ntx_terminal as (\r\n\r\n    select \r\n             T.[Terminal Id] as TxID, \r\n             T.Teknisk as [NE Type] ,\r\n             T.Navn as [NE Name] , \r\n             T.Gade + ' '+ T.Nr +' '+ isnull( T.Bogst,'') +' '+ isnull(T.Etage ,'') +' ' + isnull(T.Lejl,'') as [Address]  ,\r\n             T.PostNr as PostalCode ,\r\n             T.[By] as City ,\r\n             T.Geocode  \r\nfrom  stg_kat_terminal T  \r\n)\r\nselect * from tx_terminal", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "tx_terminal"], "unique_id": "model.tdcnet_bi.tx_terminal", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\tx_terminal.sql", "original_file_path": "models\\marts\\remedy\\tx_terminal.sql", "name": "tx_terminal", "resource_type": "model", "alias": "tx_terminal", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_kat_terminal"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_kat_terminal"]}, "description": "", "columns": {"TxID": {"name": "TxID", "description": "Unique identifier for a terminal. Primary key of the terminal.", "meta": {}, "data_type": null, "tags": []}, "NE Type": {"name": "NE Type", "description": "Type of terminal.", "meta": {}, "data_type": null, "tags": []}, "NE Name": {"name": "NE Name", "description": "Terminal Name.", "meta": {}, "data_type": null, "tags": []}, "Address": {"name": "Address", "description": "Address of the terminal.", "meta": {}, "data_type": null, "tags": []}, "PostalCode": {"name": "PostalCode", "description": "Postal code of the terminal.", "meta": {}, "data_type": null, "tags": []}, "City": {"name": "City", "description": "City to which the terminal belongs.", "meta": {}, "data_type": null, "tags": []}, "Geocode": {"name": "Geocode", "description": "Geocode of the terminal.", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\tx_terminal.sql", "compiled": true, "compiled_sql": "With stg_kat_terminal as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_terminal\"\n),\n\ntx_terminal as (\n\n    select \n             T.[Terminal Id] as TxID, \n             T.Teknisk as [NE Type] ,\n             T.Navn as [NE Name] , \n             T.Gade + ' '+ T.Nr +' '+ isnull( T.Bogst,'') +' '+ isnull(T.Etage ,'') +' ' + isnull(T.Lejl,'') as [Address]  ,\n             T.PostNr as PostalCode ,\n             T.[By] as City ,\n             T.Geocode  \nfrom  stg_kat_terminal T  \n)\nselect * from tx_terminal", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With stg_kat_terminal as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_terminal\"\n),\n\ntx_terminal as (\n\n    select \n             T.[Terminal Id] as TxID, \n             T.Teknisk as [NE Type] ,\n             T.Navn as [NE Name] , \n             T.Gade + ' '+ T.Nr +' '+ isnull( T.Bogst,'') +' '+ isnull(T.Etage ,'') +' ' + isnull(T.Lejl,'') as [Address]  ,\n             T.PostNr as PostalCode ,\n             T.[By] as City ,\n             T.Geocode  \nfrom  stg_kat_terminal T  \n)\nselect * from tx_terminal", "wrapped_sql": null}, "error": null, "status": "50", "execution_time": 0.08580899238586426, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:04.978498Z", "completed_at": "2020-05-07T06:49:04.991890Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:04.991890Z", "completed_at": "2020-05-07T06:49:05.063810Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Stg_Ramsite_Cell as (\r\n\r\n    select * from {{ ref('stg_ramsite_cell') }}\r\n),\r\n\r\nmobile_cell as (\r\n\r\n    select \r\n             [Cell Id],\r\n             '' test1,\r\n             [Site Id] ,\r\n             Name  as [Cell Name] ,\r\n             Status as [Cell Status],\r\n             case \r\n                          when [System Type] like '%GSM%' then '2G'\r\n                          when [System Type] like '%UMTS%' then '3G'\r\n                          when [System Type] like '%LTE%' then '4G'\r\n                          else '5G'\r\n             end [Cell Type],\r\n             [System Type] ,\r\n             [Traffic Area] ,\r\n             Position as Cell_Position,\r\n             Azimuth ,\r\n             Sector ,\r\n             Radius as [Cell Radius],\r\n             NodeName as [NodeName],\r\n             [eNodeB ID] as [eNodeB ID],\r\n             [gNodeB ID] as [gNodeB ID] ,\r\n             BSC_RNC as BSC_RNC \r\n    from    \r\n                stg_ramsite_cell\r\n\r\n)\r\n\r\nselect * from mobile_cell", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "mobile_cell"], "unique_id": "model.tdcnet_bi.mobile_cell", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\mobile_cell.sql", "original_file_path": "models\\marts\\remedy\\mobile_cell.sql", "name": "mobile_cell", "resource_type": "model", "alias": "mobile_cell", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_ramsite_cell"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_ramsite_cell"]}, "description": "", "columns": {"Cell ID": {"name": "Cell ID", "description": "unique number Cell ID", "meta": {}, "data_type": null, "tags": []}, "SiteID": {"name": "SiteID", "description": "Sell ID present under which site ( site iD)", "meta": {}, "data_type": null, "tags": []}, "Cell Name": {"name": "Cell Name", "description": "Cell Name", "meta": {}, "data_type": null, "tags": []}, "Cell Status": {"name": "Cell Status", "description": "Cell Status (OnAir/Not OnAir/Disabled/Deactivated)", "meta": {}, "data_type": null, "tags": []}, "Cell Type": {"name": "Cell Type", "description": "Cell Type 2G,3G,4G,5G", "meta": {}, "data_type": null, "tags": []}, "System Type": {"name": "System Type", "description": "cell system GSM/LITE/UMTS", "meta": {}, "data_type": null, "tags": []}, "Traffic Area": {"name": "Traffic Area", "description": "Traffic Area", "meta": {}, "data_type": null, "tags": []}, "Cell_Position": {"name": "Cell_Position", "description": "Cell_Position", "meta": {}, "data_type": null, "tags": []}, "Azimuth": {"name": "Azimuth", "description": "Azimuth", "meta": {}, "data_type": null, "tags": []}, "Sector": {"name": "Sector", "description": "Sector", "meta": {}, "data_type": null, "tags": []}, "Cell Radius": {"name": "Cell Radius", "description": "Cell Radius or Range", "meta": {}, "data_type": null, "tags": []}, "NodeName": {"name": "NodeName", "description": "Node Name", "meta": {}, "data_type": null, "tags": []}, "eNodeB ID": {"name": "eNodeB ID", "description": "identifying an eNB", "meta": {}, "data_type": null, "tags": []}, "gNodeB ID": {"name": "gNodeB ID", "description": "Global eNB ID", "meta": {}, "data_type": null, "tags": []}, "BSC_RNC": {"name": "BSC_RNC", "description": "BSC_RNC", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\mobile_cell.sql", "compiled": true, "compiled_sql": "With Stg_Ramsite_Cell as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_cell\"\n),\n\nmobile_cell as (\n\n    select \n             [Cell Id],\n             '' test1,\n             [Site Id] ,\n             Name  as [Cell Name] ,\n             Status as [Cell Status],\n             case \n                          when [System Type] like '%GSM%' then '2G'\n                          when [System Type] like '%UMTS%' then '3G'\n                          when [System Type] like '%LTE%' then '4G'\n                          else '5G'\n             end [Cell Type],\n             [System Type] ,\n             [Traffic Area] ,\n             Position as Cell_Position,\n             Azimuth ,\n             Sector ,\n             Radius as [Cell Radius],\n             NodeName as [NodeName],\n             [eNodeB ID] as [eNodeB ID],\n             [gNodeB ID] as [gNodeB ID] ,\n             BSC_RNC as BSC_RNC \n    from    \n                stg_ramsite_cell\n\n)\n\nselect * from mobile_cell", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Stg_Ramsite_Cell as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_cell\"\n),\n\nmobile_cell as (\n\n    select \n             [Cell Id],\n             '' test1,\n             [Site Id] ,\n             Name  as [Cell Name] ,\n             Status as [Cell Status],\n             case \n                          when [System Type] like '%GSM%' then '2G'\n                          when [System Type] like '%UMTS%' then '3G'\n                          when [System Type] like '%LTE%' then '4G'\n                          else '5G'\n             end [Cell Type],\n             [System Type] ,\n             [Traffic Area] ,\n             Position as Cell_Position,\n             Azimuth ,\n             Sector ,\n             Radius as [Cell Radius],\n             NodeName as [NodeName],\n             [eNodeB ID] as [eNodeB ID],\n             [gNodeB ID] as [gNodeB ID] ,\n             BSC_RNC as BSC_RNC \n    from    \n                stg_ramsite_cell\n\n)\n\nselect * from mobile_cell", "wrapped_sql": null}, "error": null, "status": "48", "execution_time": 0.09919905662536621, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:05.068275Z", "completed_at": "2020-05-07T06:49:05.087122Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:05.087618Z", "completed_at": "2020-05-07T06:49:05.166011Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Stg_Ramsite_Site as (\r\n\r\n    select * from {{ ref('stg_ramsite_site') }}\r\n),\r\n Stg_Kat_Terminal as (\r\n\r\n    select * from {{ ref('stg_kat_terminal') }}\r\n),\r\nStg_Kat_MobileCircuit as (\r\n\r\n    select * from {{ ref('stg_kat_mobilecircuit') }}\r\n),\r\nSite_CTE  \r\n\tAS  \r\n\t(\r\n\tselect [Site Id] ,   \r\n\t\t\t\t\t\t\tcase \r\n\t\t\t\t\t\t\t\t\t\twhen substring(  value  , len(value)  , len(value) ) in ('U','L') \r\n\t\t\t\t\t\t\t\t\t\tthen  substring(  value  ,1, len(value) -1 )\r\n\t\t\t\t\t\t\telse value\r\n\t\t\t\t\t\t\tend as CircuitId\r\n\tfrom stg_ramsite_site S   \r\n\tCROSS APPLY STRING_SPLIT(S.CircuitIds, ',') \r\n\t) ,\r\nphysical_location_site as (\r\n\r\n    \r\n\tselect DISTINCT\r\n\tsubstring ( navn ,1, charindex(' ', navn )) as [Site ID] ,\r\n\tmc.[Mobile Terminal], \r\n\tS.[Site Status] as [Site Status],\r\n\tS.[Site Name],\r\n\tS.[English Name],\r\n\tS.Cluster,\r\n\tS.Priority as [Site Priority],  \r\n\tS.[RNC ID] ,\r\n\tS.[BSC ID] ,\r\n\tS.[EPC ID] ,\r\n\tS.[Address 1] + ' '+ S.[House No]  as [Address] ,\r\n\ts.PostCode as [PostalCode],\r\n\ts.City,\r\n\tS.Municipality as Municipal,\r\n\tS.County as Region,\r\n\tS.[Easting UTM32-ED50] ,\r\n\tS.[Northing UTM32-ED50] ,\r\n\tS.[Longitude-WGS84] , \r\n\tS.[Latitude-WGS84] \r\n\tfrom \r\n\t\t\t\tstg_ramsite_site S \r\n\t\t\t\t\tjoin \r\n\t\t\t\tstg_kat_terminal T \r\n\t\t\t\t\t\t\ton replicate( '0' , 4-len([Site Id])  ) + [Site Id] = substring ( navn ,1, charindex(' ', navn )) \r\n\t\t\t\t\t\t\tand S.City = T.[By]\r\n\t\t\t\t\t\t\tand S.PostCode = T.PostNr\r\n\t\tjoin\r\n\t\t\t\tstg_kat_mobilecircuit mc\r\n\t\t\t\t\t\t\ton  T.[Terminal Id] = mc.[Mobile Terminal]\r\n\t\t\t\t\tjoin\r\n\t\t\t\tSite_CTE SC\r\n\t\t\t\t\t\t\ton S.[Site Id] = SC.[Site Id]\r\n\t\t\t\t\t\t\tand SC.CircuitId = mc.circuitid\r\n\twhere \r\n\t\t\t\t-- S.[Site Status] IN ('On Air','Ready') and\r\n\t\t\t\t upper(mc.[Mobile Terminal]) like '%TDM%' \r\n\r\n)\r\n\r\nselect * from physical_location_site", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "physical_location_site"], "unique_id": "model.tdcnet_bi.physical_location_site", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\physical_location_site.sql", "original_file_path": "models\\marts\\remedy\\physical_location_site.sql", "name": "physical_location_site", "resource_type": "model", "alias": "physical_location_site", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_ramsite_site"], ["stg_kat_terminal"], ["stg_kat_mobilecircuit"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_ramsite_site", "model.tdcnet_bi.stg_kat_terminal", "model.tdcnet_bi.stg_kat_mobilecircuit"]}, "description": "", "columns": {"Site ID": {"name": "Site ID", "description": "Site ID or  Mobile terminals ID", "meta": {}, "data_type": null, "tags": []}, "Mobile Terminal": {"name": "Mobile Terminal", "description": "Mobile terminals", "meta": {}, "data_type": null, "tags": []}, "Site Status": {"name": "Site Status", "description": "Site  or  Mobile terminals status", "meta": {}, "data_type": null, "tags": []}, "Site Name": {"name": "Site Name", "description": "Site name in Danish", "meta": {}, "data_type": null, "tags": []}, "English Name": {"name": "English Name", "description": "Site  Name in English", "meta": {}, "data_type": null, "tags": []}, "Cluster": {"name": "Cluster", "description": "Site  under which Cluster", "meta": {}, "data_type": null, "tags": []}, "Site Priority": {"name": "Site Priority", "description": "define different impact severity depending on the type of site", "meta": {}, "data_type": null, "tags": []}, "RNC ID": {"name": "RNC ID", "description": "Radio Network Controller ID", "meta": {}, "data_type": null, "tags": []}, "BSC ID": {"name": "BSC ID", "description": "Base Station Controller ID", "meta": {}, "data_type": null, "tags": []}, "EPC ID": {"name": "EPC ID", "description": "Evolved Packet Core ID", "meta": {}, "data_type": null, "tags": []}, "Address": {"name": "Address", "description": "Site Address", "meta": {}, "data_type": null, "tags": []}, "PostalCode": {"name": "PostalCode", "description": "Site Postal Code or Pin Code", "meta": {}, "data_type": null, "tags": []}, "City": {"name": "City", "description": "Site Under which City", "meta": {}, "data_type": null, "tags": []}, "Municipal": {"name": "Municipal", "description": "Site Under which Municipal", "meta": {}, "data_type": null, "tags": []}, "Region": {"name": "Region", "description": "Site Under which Region", "meta": {}, "data_type": null, "tags": []}, "Easting UTM32-ED50": {"name": "Easting UTM32-ED50", "description": "Location details Easting UTM32", "meta": {}, "data_type": null, "tags": []}, "Norting UTM32-ED50": {"name": "Norting UTM32-ED50", "description": "Location details Norting UTM32", "meta": {}, "data_type": null, "tags": []}, "LONGITUDE-WGS84": {"name": "LONGITUDE-WGS84", "description": "Location details LONGITUDE", "meta": {}, "data_type": null, "tags": []}, "LATITUDE-WGS84": {"name": "LATITUDE-WGS84", "description": "Location details LATITUDE", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\physical_location_site.sql", "compiled": true, "compiled_sql": "With Stg_Ramsite_Site as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_site\"\n),\n Stg_Kat_Terminal as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_terminal\"\n),\nStg_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_mobilecircuit\"\n),\nSite_CTE  \n\tAS  \n\t(\n\tselect [Site Id] ,   \n\t\t\t\t\t\t\tcase \n\t\t\t\t\t\t\t\t\t\twhen substring(  value  , len(value)  , len(value) ) in ('U','L') \n\t\t\t\t\t\t\t\t\t\tthen  substring(  value  ,1, len(value) -1 )\n\t\t\t\t\t\t\telse value\n\t\t\t\t\t\t\tend as CircuitId\n\tfrom stg_ramsite_site S   \n\tCROSS APPLY STRING_SPLIT(S.CircuitIds, ',') \n\t) ,\nphysical_location_site as (\n\n    \n\tselect DISTINCT\n\tsubstring ( navn ,1, charindex(' ', navn )) as [Site ID] ,\n\tmc.[Mobile Terminal], \n\tS.[Site Status] as [Site Status],\n\tS.[Site Name],\n\tS.[English Name],\n\tS.Cluster,\n\tS.Priority as [Site Priority],  \n\tS.[RNC ID] ,\n\tS.[BSC ID] ,\n\tS.[EPC ID] ,\n\tS.[Address 1] + ' '+ S.[House No]  as [Address] ,\n\ts.PostCode as [PostalCode],\n\ts.City,\n\tS.Municipality as Municipal,\n\tS.County as Region,\n\tS.[Easting UTM32-ED50] ,\n\tS.[Northing UTM32-ED50] ,\n\tS.[Longitude-WGS84] , \n\tS.[Latitude-WGS84] \n\tfrom \n\t\t\t\tstg_ramsite_site S \n\t\t\t\t\tjoin \n\t\t\t\tstg_kat_terminal T \n\t\t\t\t\t\t\ton replicate( '0' , 4-len([Site Id])  ) + [Site Id] = substring ( navn ,1, charindex(' ', navn )) \n\t\t\t\t\t\t\tand S.City = T.[By]\n\t\t\t\t\t\t\tand S.PostCode = T.PostNr\n\t\tjoin\n\t\t\t\tstg_kat_mobilecircuit mc\n\t\t\t\t\t\t\ton  T.[Terminal Id] = mc.[Mobile Terminal]\n\t\t\t\t\tjoin\n\t\t\t\tSite_CTE SC\n\t\t\t\t\t\t\ton S.[Site Id] = SC.[Site Id]\n\t\t\t\t\t\t\tand SC.CircuitId = mc.circuitid\n\twhere \n\t\t\t\t-- S.[Site Status] IN ('On Air','Ready') and\n\t\t\t\t upper(mc.[Mobile Terminal]) like '%TDM%' \n\n)\n\nselect * from physical_location_site", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Stg_Ramsite_Site as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_site\"\n),\n Stg_Kat_Terminal as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_terminal\"\n),\nStg_Kat_MobileCircuit as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_mobilecircuit\"\n),\nSite_CTE  \n\tAS  \n\t(\n\tselect [Site Id] ,   \n\t\t\t\t\t\t\tcase \n\t\t\t\t\t\t\t\t\t\twhen substring(  value  , len(value)  , len(value) ) in ('U','L') \n\t\t\t\t\t\t\t\t\t\tthen  substring(  value  ,1, len(value) -1 )\n\t\t\t\t\t\t\telse value\n\t\t\t\t\t\t\tend as CircuitId\n\tfrom stg_ramsite_site S   \n\tCROSS APPLY STRING_SPLIT(S.CircuitIds, ',') \n\t) ,\nphysical_location_site as (\n\n    \n\tselect DISTINCT\n\tsubstring ( navn ,1, charindex(' ', navn )) as [Site ID] ,\n\tmc.[Mobile Terminal], \n\tS.[Site Status] as [Site Status],\n\tS.[Site Name],\n\tS.[English Name],\n\tS.Cluster,\n\tS.Priority as [Site Priority],  \n\tS.[RNC ID] ,\n\tS.[BSC ID] ,\n\tS.[EPC ID] ,\n\tS.[Address 1] + ' '+ S.[House No]  as [Address] ,\n\ts.PostCode as [PostalCode],\n\ts.City,\n\tS.Municipality as Municipal,\n\tS.County as Region,\n\tS.[Easting UTM32-ED50] ,\n\tS.[Northing UTM32-ED50] ,\n\tS.[Longitude-WGS84] , \n\tS.[Latitude-WGS84] \n\tfrom \n\t\t\t\tstg_ramsite_site S \n\t\t\t\t\tjoin \n\t\t\t\tstg_kat_terminal T \n\t\t\t\t\t\t\ton replicate( '0' , 4-len([Site Id])  ) + [Site Id] = substring ( navn ,1, charindex(' ', navn )) \n\t\t\t\t\t\t\tand S.City = T.[By]\n\t\t\t\t\t\t\tand S.PostCode = T.PostNr\n\t\tjoin\n\t\t\t\tstg_kat_mobilecircuit mc\n\t\t\t\t\t\t\ton  T.[Terminal Id] = mc.[Mobile Terminal]\n\t\t\t\t\tjoin\n\t\t\t\tSite_CTE SC\n\t\t\t\t\t\t\ton S.[Site Id] = SC.[Site Id]\n\t\t\t\t\t\t\tand SC.CircuitId = mc.circuitid\n\twhere \n\t\t\t\t-- S.[Site Status] IN ('On Air','Ready') and\n\t\t\t\t upper(mc.[Mobile Terminal]) like '%TDM%' \n\n)\n\nselect * from physical_location_site", "wrapped_sql": null}, "error": null, "status": "6", "execution_time": 0.2009119987487793, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:05.168467Z", "completed_at": "2020-05-07T06:49:05.187811Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:05.187811Z", "completed_at": "2020-05-07T06:49:05.368387Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With Stg_Ramsite_Site as (\r\n\r\n    select * from {{ ref('stg_ramsite_site') }}\r\n),\r\nStg_Ramsite_Cell as (\r\n\r\n    select * from {{ ref('stg_ramsite_cell') }}\r\n),\r\n piv_tab as\r\n      (\r\n                  select * from (\r\n                  select distinct \r\n                    RamSite_Site.[Site Id] , \r\n                    RamSite_Site.[Site Type] ,\r\n                  case \r\n                                when RamSite_Cell.[System Type] like '%GSM%' then '2G'\r\n                                when RamSite_Cell.[System Type] like '%UMTS%' then '3G'\r\n                                when RamSite_Cell.[System Type] like '%LTE%' then '4G'\r\n                                else '5G'\r\n                  end [Cell Type]\r\n                  from \r\n                                stg_ramsite_site as RamSite_Site\r\n                                join\r\n                                stg_ramsite_cell as RamSite_Cell\r\n                                on RamSite_Site.[Site Id] = RamSite_Cell.[Site Id]\r\n                                where RamSite_Cell.Status = 'OnAir') AS src \r\n                                PIVOT(\r\n                                            max([Cell Type])\r\n                                            FOR [Cell Type] IN ([2G],[3G],[4G],[5G]) ) as int_piv_tab\r\n        ),  \r\nsite_type as (\r\n\r\n      select \r\n                  [Site Id],\r\n                  [Site Type],\r\n                  case when [2G] is not null then 'Yes' else 'No' end [2G] ,\r\n                  case when [3G] is not null then 'Yes' else 'No' end [3G],\r\n                  case when [4G] is not null then 'Yes' else 'No' end [4G],\r\n                  case when [5G] is not null then 'Yes' else 'No' end [5G]\r\n      from piv_tab\r\n \r\n)\r\n\r\nselect * from site_type", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "site_type"], "unique_id": "model.tdcnet_bi.site_type", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\site_type.sql", "original_file_path": "models\\marts\\remedy\\site_type.sql", "name": "site_type", "resource_type": "model", "alias": "site_type", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_ramsite_site"], ["stg_ramsite_cell"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_ramsite_site", "model.tdcnet_bi.stg_ramsite_cell"]}, "description": "", "columns": {"Site ID": {"name": "Site ID", "description": "Primary key of the table which is Unique", "meta": {}, "data_type": null, "tags": []}, "Site Type": {"name": "Site Type", "description": "types of telecommunication Site", "meta": {}, "data_type": null, "tags": []}, "2G": {"name": "2G", "description": "weather Site support 2g or not", "meta": {}, "data_type": null, "tags": []}, "3G": {"name": "3G", "description": "weather Site support 3g or not", "meta": {}, "data_type": null, "tags": []}, "4G": {"name": "4G", "description": "weather Site support 4g or not", "meta": {}, "data_type": null, "tags": []}, "5G": {"name": "5G", "description": "weather Site support 5g or not", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\site_type.sql", "compiled": true, "compiled_sql": "With Stg_Ramsite_Site as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_site\"\n),\nStg_Ramsite_Cell as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_cell\"\n),\n piv_tab as\n      (\n                  select * from (\n                  select distinct \n                    RamSite_Site.[Site Id] , \n                    RamSite_Site.[Site Type] ,\n                  case \n                                when RamSite_Cell.[System Type] like '%GSM%' then '2G'\n                                when RamSite_Cell.[System Type] like '%UMTS%' then '3G'\n                                when RamSite_Cell.[System Type] like '%LTE%' then '4G'\n                                else '5G'\n                  end [Cell Type]\n                  from \n                                stg_ramsite_site as RamSite_Site\n                                join\n                                stg_ramsite_cell as RamSite_Cell\n                                on RamSite_Site.[Site Id] = RamSite_Cell.[Site Id]\n                                where RamSite_Cell.Status = 'OnAir') AS src \n                                PIVOT(\n                                            max([Cell Type])\n                                            FOR [Cell Type] IN ([2G],[3G],[4G],[5G]) ) as int_piv_tab\n        ),  \nsite_type as (\n\n      select \n                  [Site Id],\n                  [Site Type],\n                  case when [2G] is not null then 'Yes' else 'No' end [2G] ,\n                  case when [3G] is not null then 'Yes' else 'No' end [3G],\n                  case when [4G] is not null then 'Yes' else 'No' end [4G],\n                  case when [5G] is not null then 'Yes' else 'No' end [5G]\n      from piv_tab\n \n)\n\nselect * from site_type", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With Stg_Ramsite_Site as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_site\"\n),\nStg_Ramsite_Cell as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_ramsite_cell\"\n),\n piv_tab as\n      (\n                  select * from (\n                  select distinct \n                    RamSite_Site.[Site Id] , \n                    RamSite_Site.[Site Type] ,\n                  case \n                                when RamSite_Cell.[System Type] like '%GSM%' then '2G'\n                                when RamSite_Cell.[System Type] like '%UMTS%' then '3G'\n                                when RamSite_Cell.[System Type] like '%LTE%' then '4G'\n                                else '5G'\n                  end [Cell Type]\n                  from \n                                stg_ramsite_site as RamSite_Site\n                                join\n                                stg_ramsite_cell as RamSite_Cell\n                                on RamSite_Site.[Site Id] = RamSite_Cell.[Site Id]\n                                where RamSite_Cell.Status = 'OnAir') AS src \n                                PIVOT(\n                                            max([Cell Type])\n                                            FOR [Cell Type] IN ([2G],[3G],[4G],[5G]) ) as int_piv_tab\n        ),  \nsite_type as (\n\n      select \n                  [Site Id],\n                  [Site Type],\n                  case when [2G] is not null then 'Yes' else 'No' end [2G] ,\n                  case when [3G] is not null then 'Yes' else 'No' end [3G],\n                  case when [4G] is not null then 'Yes' else 'No' end [4G],\n                  case when [5G] is not null then 'Yes' else 'No' end [5G]\n      from piv_tab\n \n)\n\nselect * from site_type", "wrapped_sql": null}, "error": null, "status": "3", "execution_time": 0.08878540992736816, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:05.371330Z", "completed_at": "2020-05-07T06:49:05.383730Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:05.383730Z", "completed_at": "2020-05-07T06:49:05.459155Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "With stg_kat_sharedcableplant as (\r\n\r\n    select * from {{ ref('stg_kat_sharedcableplant') }}\r\n),\r\n\r\nshare_cable as (\r\n\r\n    select \r\n             [Share Cable Nr] as CableID,\r\n             substring ( substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) , charindex('-', substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) )+1,len(substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ))  ) as [Terminal 1_RTN],\r\n             substring ( substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) ,1, charindex('-', substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) )-1 ) as [Terminal 2_Lmile T.],\r\n             [Last Mile Cable Junction] as [Lmile Cable Junction],\r\n             [Last Mile Junction Terminal] as [Lmile Junction Terminal],\r\n             [Cable Status]\r\n    from stg_kat_sharedcableplant\r\n\r\n)\r\nselect * from share_cable", "database": "DDMP_DML", "schema": "dbo", "fqn": ["tdcnet_bi", "marts", "remedy", "share_cable"], "unique_id": "model.tdcnet_bi.share_cable", "package_name": "tdcnet_bi", "root_path": "D:\\DBT\\DBTProject\\Kat_Ramsite_To_Remedy_Transformation_Master", "path": "marts\\remedy\\share_cable.sql", "original_file_path": "models\\marts\\remedy\\share_cable.sql", "name": "share_cable", "resource_type": "model", "alias": "share_cable", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_kat_sharedcableplant"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.tdcnet_bi.stg_kat_sharedcableplant"]}, "description": "", "columns": {"CableID": {"name": "CableID", "description": "unique Cable ID", "meta": {}, "data_type": null, "tags": []}, "Terminal 1_RTN": {"name": "Terminal 1_RTN", "description": "Terminal 1 RTN", "meta": {}, "data_type": null, "tags": []}, "Terminal 2_Lmile T": {"name": "Terminal 2_Lmile T", "description": "Terminal 2 Lmile T", "meta": {}, "data_type": null, "tags": []}, "Lmile Cable Junction": {"name": "Lmile Cable Junction", "description": "Lmile Cable Junction", "meta": {}, "data_type": null, "tags": []}, "Lmile Junction Terminal": {"name": "Lmile Junction Terminal", "description": "Lmile Junction Terminal", "meta": {}, "data_type": null, "tags": []}, "Cable Status": {"name": "Cable Status", "description": "Cable Status", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models\\marts\\remedy\\remedy.yml", "build_path": "target\\run\\tdcnet_bi\\marts\\remedy\\share_cable.sql", "compiled": true, "compiled_sql": "With stg_kat_sharedcableplant as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_sharedcableplant\"\n),\n\nshare_cable as (\n\n    select \n             [Share Cable Nr] as CableID,\n             substring ( substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) , charindex('-', substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) )+1,len(substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ))  ) as [Terminal 1_RTN],\n             substring ( substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) ,1, charindex('-', substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) )-1 ) as [Terminal 2_Lmile T.],\n             [Last Mile Cable Junction] as [Lmile Cable Junction],\n             [Last Mile Junction Terminal] as [Lmile Junction Terminal],\n             [Cable Status]\n    from stg_kat_sharedcableplant\n\n)\nselect * from share_cable", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "With stg_kat_sharedcableplant as (\n\n    select * from \"DDMP_DML\".\"dbo\".\"stg_kat_sharedcableplant\"\n),\n\nshare_cable as (\n\n    select \n             [Share Cable Nr] as CableID,\n             substring ( substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) , charindex('-', substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) )+1,len(substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ))  ) as [Terminal 1_RTN],\n             substring ( substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) ,1, charindex('-', substring ([Share Cable Id],1,len([Share Cable Id])-len([Share Cable Nr]) ) )-1 ) as [Terminal 2_Lmile T.],\n             [Last Mile Cable Junction] as [Lmile Cable Junction],\n             [Last Mile Junction Terminal] as [Lmile Junction Terminal],\n             [Cable Status]\n    from stg_kat_sharedcableplant\n\n)\nselect * from share_cable", "wrapped_sql": null}, "error": null, "status": "6", "execution_time": 0.0709540843963623, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-07T06:49:05.462100Z", "completed_at": "2020-05-07T06:49:05.472514Z"}, {"name": "execute", "started_at": "2020-05-07T06:49:05.473010Z", "completed_at": "2020-05-07T06:49:05.532556Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-05-07T06:49:05.537490Z", "elapsed_time": 1.6739799976348877}